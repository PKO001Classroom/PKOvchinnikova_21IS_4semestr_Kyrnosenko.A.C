{% extends "base.html" %}

{% block title %}–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/admin.css">
{% endblock %}

{% block content %}
<div class="admin-container">
    <h1>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</h1>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="admin-stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üë•</div>
            <div class="stat-content">
                <div class="stat-value">{{ total_users }}</div>
                <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                <div class="stat-detail">–°—Ç—É–¥–µ–Ω—Ç–æ–≤: {{ total_students }}</div>
                <div class="stat-detail">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π: {{ total_teachers }}</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üìö</div>
            <div class="stat-content">
                <div class="stat-value">{{ total_courses }}</div>
                <div class="stat-label">–í—Å–µ–≥–æ –∫—É—Ä—Å–æ–≤</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üìù</div>
            <div class="stat-content">
                <div class="stat-value">{{ total_assignments }}</div>
                <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–¥–∞–Ω–∏–π</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üì§</div>
            <div class="stat-content">
                <div class="stat-value">{{ total_submissions }}</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Å–¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç</div>
            </div>
        </div>
    </div>
    
    <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
    <div class="admin-actions">
        <h2>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
        
        <div class="actions-grid">
            <a href="/admin/users" class="action-card">
                <span class="action-icon">üë•</span>
                <span class="action-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</span>
                <span class="action-desc">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞</span>
            </a>
            
            <a href="/admin/import-users" class="action-card">
                <span class="action-icon">üì•</span>
                <span class="action-title">–ò–º–ø–æ—Ä—Ç –∏–∑ CSV</span>
                <span class="action-desc">–ú–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</span>
            </a>
            
            <a href="/courses" class="action-card">
                <span class="action-icon">üìö</span>
                <span class="action-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏</span>
                <span class="action-desc">–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—É—Ä—Å–æ–≤</span>
            </a>
            
            <a href="/grades" class="action-card">
                <span class="action-icon">üìä</span>
                <span class="action-title">–û—Ç—á–µ—Ç—ã</span>
                <span class="action-desc">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏</span>
            </a>
        </div>
    </div>
    
    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
    <div class="recent-section">
        <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>
        
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Email</th>
                    <th>–§–ò–û</th>
                    <th>–†–æ–ª—å</th>
                    <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for u in recent_users %}
                <tr>
                    <td>{{ u.email }}</td>
                    <td>{{ u.full_name }}</td>
                    <td>
                        <span class="role-badge role-{{ u.role }}">
                            {{ u.role }}
                        </span>
                    </td>
                    <td>{{ u.created_at.strftime('%d.%m.%Y') }}</td>
                    <td>
                        {% if u.is_active %}
                        <span class="status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>
                        {% else %}
                        <span class="status-inactive">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="/admin/users?search={{ u.email }}" class="btn-small">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫—É—Ä—Å—ã -->
    <div class="recent-section">
        <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∫—É—Ä—Å—ã</h2>
        
        <table class="admin-table">
            <thead>
                <tr>
                    <th>–ö–æ–¥</th>
                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                    <th>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</th>
                    <th>–°—Ç—É–¥–µ–Ω—Ç–æ–≤</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for c in recent_courses %}
                <tr>
                    <td>{{ c.code }}</td>
                    <td>{{ c.name }}</td>
                    <td>{{ c.teacher.full_name }}</td>
                    <td>{{ c.students|length }}/{{ c.max_students }}</td>
                    <td>
                        <span class="status-{{ c.status.value }}">
                            {{ c.status.value }}
                        </span>
                    </td>
                    <td>
                        <a href="/courses/{{ c.id }}" class="btn-small">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}