<!DOCTYPE html>
<html>
<head>
    <title>EduGrader –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>
    <style>
        body { font-family: Arial; padding: 20px; max-width: 800px; margin: 0 auto; background: #f0f2f5; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .tab { padding: 10px 20px; cursor: pointer; background: #f5f5f5; border: 1px solid #ddd; margin-right: 5px; border-radius: 5px; display: inline-block; }
        .tab.active { background: #1a73e8; color: white; }
        .tab-content { display: none; padding: 20px; }
        .tab-content.active { display: block; }
        input, select, textarea, button { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { background: #1a73e8; color: white; border: none; cursor: pointer; font-size: 16px; }
        button:hover { background: #1557b0; }
        pre { background: #f8f9fa; padding: 15px; border-radius: 8px; overflow: auto; }
        .course-card { background: #f9f9f9; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid #1a73e8; }
        .notification { background: #e7f3ff; padding: 10px; margin: 5px 0; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö EduGrader - –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è –≤–µ—Ä—Å–∏—è</h1>
        <p>‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞! –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ.</p>
        
        <div>
            <span class="tab active" onclick="showTab('auth')">üîê –í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
            <span class="tab" onclick="showTab('courses')">üìö –ö—É—Ä—Å—ã</span>
            <span class="tab" onclick="showTab('grades')">üìä –û—Ü–µ–Ω–∫–∏</span>
            <span class="tab" onclick="showTab('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div id="auth" class="tab-content active">
            <h3>üîê –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è / –í—Ö–æ–¥</h3>
            <input type="text" id="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å">
            <select id="role">
                <option value="student">–°—Ç—É–¥–µ–Ω—Ç</option>
                <option value="teacher">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</option>
            </select>
            <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            <button onclick="login()">–í–æ–π—Ç–∏</button>
            
            <div id="current-user"></div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –∫—É—Ä—Å–æ–≤ -->
        <div id="courses" class="tab-content">
            <h3>üìö –ú–æ–∏ –∫—É—Ä—Å—ã</h3>
            <button onclick="showAddCourse()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—Å</button>
            <div id="course-list"></div>
            
            <div id="add-course-form" style="display: none;">
                <h4>–ù–æ–≤—ã–π –∫—É—Ä—Å</h4>
                <input type="text" id="course-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞">
                <input type="text" id="course-code" placeholder="–ö–æ–¥ –∫—É—Ä—Å–∞">
                <textarea id="course-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
                <button onclick="addCourse()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button onclick="cancelAddCourse()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –æ—Ü–µ–Ω–æ–∫ -->
        <div id="grades" class="tab-content">
            <h3>üìä –ú–æ–∏ –æ—Ü–µ–Ω–∫–∏</h3>
            <div id="grades-list"></div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile" class="tab-content">
            <h3>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h3>
            <div id="profile-info"></div>
            <button onclick="logout()">–í—ã–π—Ç–∏</button>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
        <div class="notification" id="result"></div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        let db = {
            users: JSON.parse(localStorage.getItem('users')) || [],
            courses: JSON.parse(localStorage.getItem('courses')) || [],
            enrollments: JSON.parse(localStorage.getItem('enrollments')) || [],
            grades: JSON.parse(localStorage.getItem('grades')) || [],
            currentUser: JSON.parse(localStorage.getItem('currentUser')) || null
        };

        function saveToStorage() {
            localStorage.setItem('users', JSON.stringify(db.users));
            localStorage.setItem('courses', JSON.stringify(db.courses));
            localStorage.setItem('enrollments', JSON.stringify(db.enrollments));
            localStorage.setItem('grades', JSON.stringify(db.grades));
            localStorage.setItem('currentUser', JSON.stringify(db.currentUser));
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            updateUI();
        }

        function showResult(message, isError = false) {
            const result = document.getElementById('result');
            result.style.background = isError ? '#f8d7da' : '#d4edda';
            result.style.color = isError ? '#721c24' : '#155724';
            result.textContent = message;
        }

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        function register() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;

            if (!username || !password) {
                showResult('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', true);
                return;
            }

            if (db.users.find(u => u.username === username)) {
                showResult('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', true);
                return;
            }

            const newUser = {
                id: Date.now(),
                username,
                password: btoa(password), // –ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–Ω–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞!)
                role,
                fullName: username,
                createdAt: new Date().toISOString()
            };

            db.users.push(newUser);
            saveToStorage();
            showResult('‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ.');
        }

        // –í—Ö–æ–¥
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const user = db.users.find(u => u.username === username && u.password === btoa(password));
            
            if (user) {
                db.currentUser = user;
                saveToStorage();
                updateUI();
                showResult(`‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${user.username}!`);
            } else {
                showResult('‚ùå –ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å', true);
            }
        }

        // –í—ã—Ö–æ–¥
        function logout() {
            db.currentUser = null;
            saveToStorage();
            updateUI();
            showResult('üëã –í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞
        function showAddCourse() {
            document.getElementById('add-course-form').style.display = 'block';
        }

        function cancelAddCourse() {
            document.getElementById('add-course-form').style.display = 'none';
        }

        function addCourse() {
            if (!db.currentUser || db.currentUser.role !== 'teacher') {
                showResult('–¢–æ–ª—å–∫–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫—É—Ä—Å—ã', true);
                return;
            }

            const course = {
                id: Date.now(),
                name: document.getElementById('course-name').value,
                code: document.getElementById('course-code').value,
                description: document.getElementById('course-desc').value,
                teacherId: db.currentUser.id,
                teacherName: db.currentUser.username,
                createdAt: new Date().toISOString()
            };

            if (!course.name || !course.code) {
                showResult('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–æ–¥ –∫—É—Ä—Å–∞', true);
                return;
            }

            db.courses.push(course);
            saveToStorage();
            cancelAddCourse();
            updateUI();
            showResult('‚úÖ –ö—É—Ä—Å —Å–æ–∑–¥–∞–Ω!');
        }

        // –ó–∞–ø–∏—Å—å –Ω–∞ –∫—É—Ä—Å
        function enrollCourse(courseId) {
            if (!db.currentUser || db.currentUser.role !== 'student') {
                showResult('–¢–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å—ã', true);
                return;
            }

            const existing = db.enrollments.find(e => e.courseId === courseId && e.studentId === db.currentUser.id);
            if (!existing) {
                db.enrollments.push({
                    id: Date.now(),
                    courseId,
                    studentId: db.currentUser.id,
                    enrolledAt: new Date().toISOString()
                });
                saveToStorage();
                updateUI();
                showResult('‚úÖ –í—ã –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –∫—É—Ä—Å!');
            }
        }

        // –í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏
        function addGrade(courseId, studentId, score) {
            if (!db.currentUser || db.currentUser.role !== 'teacher') return;

            db.grades.push({
                id: Date.now(),
                courseId,
                studentId,
                score,
                teacherId: db.currentUser.id,
                date: new Date().toISOString()
            });
            saveToStorage();
            updateUI();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            const userDiv = document.getElementById('current-user');
            if (db.currentUser) {
                userDiv.innerHTML = `
                    <div class="notification">
                        üë§ –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${db.currentUser.username} (${db.currentUser.role})
                    </div>
                `;
            } else {
                userDiv.innerHTML = '';
            }

            // –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤
            const courseList = document.getElementById('course-list');
            if (db.currentUser) {
                let courses = db.courses;
                if (db.currentUser.role === 'student') {
                    const enrolledIds = db.enrollments
                        .filter(e => e.studentId === db.currentUser.id)
                        .map(e => e.courseId);
                    courses = db.courses.filter(c => enrolledIds.includes(c.id));
                } else if (db.currentUser.role === 'teacher') {
                    courses = db.courses.filter(c => c.teacherId === db.currentUser.id);
                }

                courseList.innerHTML = courses.map(course => `
                    <div class="course-card">
                        <h4>${course.name} (${course.code})</h4>
                        <p>${course.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                        <p>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: ${course.teacherName}</p>
                        ${db.currentUser.role === 'student' ? 
                            `<button onclick="enrollCourse(${course.id})">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>` : 
                            ''}
                    </div>
                `).join('') || '–ù–µ—Ç –∫—É—Ä—Å–æ–≤';
            }

            // –û—Ü–µ–Ω–∫–∏
            const gradesList = document.getElementById('grades-list');
            if (db.currentUser && db.currentUser.role === 'student') {
                const studentGrades = db.grades.filter(g => g.studentId === db.currentUser.id);
                gradesList.innerHTML = studentGrades.map(grade => {
                    const course = db.courses.find(c => c.id === grade.courseId);
                    return `
                        <div class="course-card">
                            <p>${course ? course.name : '–ö—É—Ä—Å'}: ${grade.score} –±–∞–ª–ª–æ–≤</p>
                            <small>${new Date(grade.date).toLocaleDateString()}</small>
                        </div>
                    `;
                }).join('') || '–ù–µ—Ç –æ—Ü–µ–Ω–æ–∫';
            } else if (db.currentUser && db.currentUser.role === 'teacher') {
                // –î–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
                const teacherGrades = db.grades.filter(g => {
                    const course = db.courses.find(c => c.id === g.courseId);
                    return course && course.teacherId === db.currentUser.id;
                });
                gradesList.innerHTML = teacherGrades.map(grade => {
                    const course = db.courses.find(c => c.id === grade.courseId);
                    const student = db.users.find(u => u.id === grade.studentId);
                    return `
                        <div class="course-card">
                            <p>${course ? course.name : '–ö—É—Ä—Å'} - ${student ? student.username : '–°—Ç—É–¥–µ–Ω—Ç'}: ${grade.score} –±–∞–ª–ª–æ–≤</p>
                            <small>${new Date(grade.date).toLocaleDateString()}</small>
                        </div>
                    `;
                }).join('') || '–ù–µ—Ç –æ—Ü–µ–Ω–æ–∫';
            }

            // –ü—Ä–æ—Ñ–∏–ª—å
            const profileInfo = document.getElementById('profile-info');
            if (db.currentUser) {
                profileInfo.innerHTML = `
                    <p><strong>–ò–º—è:</strong> ${db.currentUser.fullName}</p>
                    <p><strong>–†–æ–ª—å:</strong> ${db.currentUser.role}</p>
                    <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> ${new Date(db.currentUser.createdAt).toLocaleDateString()}</p>
                `;
            }
        }

        // –ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        updateUI();

        // –î–æ–±–∞–≤–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫—É—Ä—Å–æ–≤ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
        if (db.courses.length === 0) {
            db.courses.push({
                id: 1,
                name: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Python',
                code: 'PY101',
                description: '–û—Å–Ω–æ–≤—ã Python –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö',
                teacherId: 0,
                teacherName: 'admin',
                createdAt: new Date().toISOString()
            });
            db.courses.push({
                id: 2,
                name: '–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞',
                code: 'WEB201',
                description: 'HTML, CSS, JavaScript',
                teacherId: 0,
                teacherName: 'admin',
                createdAt: new Date().toISOString()
            });
            saveToStorage();
        }
    </script>
</body>
</html>