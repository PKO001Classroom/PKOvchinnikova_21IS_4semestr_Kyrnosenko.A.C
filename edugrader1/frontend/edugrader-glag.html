<!DOCTYPE html>
<html>
<head>
    <title>EduGrader - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞–º–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: #1a237e;
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-info {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .role-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .role-student { background: #4caf50; color: white; }
        .role-teacher { background: #ff9800; color: white; }
        .role-admin { background: #f44336; color: white; }
        
        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            border-right: 1px solid #e0e0e0;
        }
        
        .tab:hover {
            background: #e0e0e0;
        }
        
        .tab.active {
            background: white;
            color: #1a237e;
            border-bottom: 3px solid #1a237e;
        }
        
        .tab-content {
            padding: 30px;
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .auth-container {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }
        
        .auth-container h2 {
            margin-bottom: 20px;
            color: #333;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-weight: 500;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #1a237e;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }
        
        .btn-primary {
            background: #1a237e;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0d1757;
        }
        
        .btn-success {
            background: #4caf50;
            color: white;
        }
        
        .btn-success:hover {
            background: #388e3c;
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-danger:hover {
            background: #d32f2f;
        }
        
        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .course-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .course-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .course-card h3 {
            color: #1a237e;
            margin-bottom: 10px;
        }
        
        .course-card .code {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .course-card .teacher {
            color: #ff9800;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px 0;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #1a237e;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        
        .grade-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .grade-table th {
            background: #1a237e;
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .grade-table td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .grade-table tr:hover {
            background: #f5f5f5;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            animation: slideIn 0.3s;
            z-index: 1001;
        }
        
        .notification.success { background: #4caf50; }
        .notification.error { background: #f44336; }
        .notification.info { background: #2196f3; }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .admin-panel {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .user-list {
            margin-top: 20px;
        }
        
        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
            }
            
            .course-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö EduGrader - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞–º–∏</h1>
            <div id="userInfo" class="user-info" style="display: none;">
                <span id="userName"></span>
                <span id="userRole" class="role-badge"></span>
                <button class="btn btn-danger" onclick="logout()" style="padding: 5px 10px; margin: 0;">–í—ã–π—Ç–∏</button>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
        <div class="tabs" id="tabs">
            <div class="tab active" onclick="showTab('auth')">üîê –í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
            <div class="tab" onclick="showTab('courses')" id="tabCourses" style="display: none;">üìö –ö—É—Ä—Å—ã</div>
            <div class="tab" onclick="showTab('myGrades')" id="tabGrades" style="display: none;">üìä –ú–æ–∏ –æ—Ü–µ–Ω–∫–∏</div>
            <div class="tab" onclick="showTab('profile')" id="tabProfile" style="display: none;">üë§ –ü—Ä–æ—Ñ–∏–ª—å</div>
            <div class="tab" onclick="showTab('admin')" id="tabAdmin" style="display: none;">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div id="auth" class="tab-content active">
            <div class="auth-container">
                <h2>üîê –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ EduGrader</h2>
                
                <div class="form-group">
                    <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="authUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" value="student">
                </div>
                
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="authPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" value="123">
                </div>
                
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ</label>
                    <select id="authAction">
                        <option value="login">–í–æ–π—Ç–∏</option>
                        <option value="register">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</option>
                    </select>
                </div>
                
                <div class="form-group" id="roleSelect" style="display: none;">
                    <label>–†–æ–ª—å</label>
                    <select id="registerRole">
                        <option value="student">–°—Ç—É–¥–µ–Ω—Ç</option>
                        <option value="teacher">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</option>
                        <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                    </select>
                </div>
                
                <button class="btn btn-primary" onclick="handleAuth()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
                
                <div style="margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px;">
                    <p><strong>–¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:</strong></p>
                    <p>üë®‚Äçüéì –°—Ç—É–¥–µ–Ω—Ç: student / 123</p>
                    <p>üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: teacher / 123</p>
                    <p>üë®‚Äçüíº –ê–¥–º–∏–Ω: admin / 123</p>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –∫—É—Ä—Å–æ–≤ -->
        <div id="courses" class="tab-content">
            <h2>üìö –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫—É—Ä—Å—ã</h2>
            
            <div id="teacherControls" style="display: none; margin-bottom: 20px;">
                <button class="btn btn-success" onclick="showCreateCourseModal()">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫—É—Ä—Å</button>
            </div>
            
            <div id="adminControls" style="display: none; margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="showAllCourses()">–í—Å–µ –∫—É—Ä—Å—ã</button>
                <button class="btn btn-primary" onclick="showPendingCourses()">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</button>
            </div>
            
            <div id="coursesList" class="course-grid"></div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –º–æ–∏—Ö –æ—Ü–µ–Ω–æ–∫ -->
        <div id="myGrades" class="tab-content">
            <h2>üìä –ú–æ–∏ –æ—Ü–µ–Ω–∫–∏</h2>
            <div id="gradesList"></div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile" class="tab-content">
            <h2>üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <div id="profileInfo" class="admin-panel"></div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <div id="admin" class="tab-content">
            <h2>‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
            
            <div class="admin-panel">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h3>
                <div id="systemStats"></div>
            </div>
            
            <div class="admin-panel">
                <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                <button class="btn btn-success" onclick="showAddUserModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                <div id="usersList" class="user-list"></div>
            </div>
            
            <div class="admin-panel">
                <h3>–í—Å–µ –∫—É—Ä—Å—ã</h3>
                <div id="allCoursesList"></div>
            </div>
            
            <div class="admin-panel">
                <h3>–í—Å–µ –æ—Ü–µ–Ω–∫–∏</h3>
                <div id="allGradesList"></div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫—É—Ä—Å–∞ -->
    <div id="createCourseModal" class="modal">
        <div class="modal-content">
            <h2>‚ûï –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫—É—Ä—Å–∞</h2>
            
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞</label>
                <input type="text" id="courseName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Python">
            </div>
            
            <div class="form-group">
                <label>–ö–æ–¥ –∫—É—Ä—Å–∞</label>
                <input type="text" id="courseCode" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: PYTHON101">
            </div>
            
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea id="courseDescription" rows="4" placeholder="–û–ø–∏—à–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∫—É—Ä—Å–∞..."></textarea>
            </div>
            
            <button class="btn btn-success" onclick="createCourse()">–°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å</button>
            <button class="btn btn-danger" onclick="closeModal('createCourseModal')">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <h2>‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            
            <div class="form-group">
                <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                <input type="text" id="newUsername">
            </div>
            
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="newPassword">
            </div>
            
            <div class="form-group">
                <label>–†–æ–ª—å</label>
                <select id="newRole">
                    <option value="student">–°—Ç—É–¥–µ–Ω—Ç</option>
                    <option value="teacher">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å</option>
                    <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                </select>
            </div>
            
            <button class="btn btn-success" onclick="addUser()">–î–æ–±–∞–≤–∏—Ç—å</button>
            <button class="btn btn-danger" onclick="closeModal('addUserModal')">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ -->
    <div id="gradeModal" class="modal">
        <div class="modal-content">
            <h2>‚≠ê –í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏</h2>
            <div id="gradeForm"></div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        let db = {
            users: JSON.parse(localStorage.getItem('users')) || [],
            courses: JSON.parse(localStorage.getItem('courses')) || [],
            enrollments: JSON.parse(localStorage.getItem('enrollments')) || [],
            grades: JSON.parse(localStorage.getItem('grades')) || [],
            currentUser: JSON.parse(localStorage.getItem('currentUser')) || null
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        function initTestData() {
            if (db.users.length === 0) {
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                db.users.push(
                    {
                        id: 1,
                        username: 'admin',
                        password: btoa('123'),
                        role: 'admin',
                        fullName: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        username: 'teacher',
                        password: btoa('123'),
                        role: 'teacher',
                        fullName: '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 3,
                        username: 'student',
                        password: btoa('123'),
                        role: 'student',
                        fullName: '–ê–Ω–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞',
                        createdAt: new Date().toISOString()
                    }
                );
            }
            
            if (db.courses.length === 0) {
                db.courses.push(
                    {
                        id: 1,
                        name: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Python',
                        code: 'PYTHON101',
                        description: '–û—Å–Ω–æ–≤—ã Python –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö',
                        teacherId: 2,
                        teacherName: '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤',
                        students: [],
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        name: '–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞',
                        code: 'WEB202',
                        description: 'HTML, CSS, JavaScript',
                        teacherId: 2,
                        teacherName: '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤',
                        students: [],
                        createdAt: new Date().toISOString()
                    }
                );
            }
            
            saveToStorage();
        }
        
        initTestData();

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
        function saveToStorage() {
            localStorage.setItem('users', JSON.stringify(db.users));
            localStorage.setItem('courses', JSON.stringify(db.courses));
            localStorage.setItem('enrollments', JSON.stringify(db.enrollments));
            localStorage.setItem('grades', JSON.stringify(db.grades));
            localStorage.setItem('currentUser', JSON.stringify(db.currentUser));
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
        function updateUI() {
            if (db.currentUser) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
                document.getElementById('userInfo').style.display = 'flex';
                document.getElementById('userName').textContent = db.currentUser.fullName || db.currentUser.username;
                document.getElementById('userRole').textContent = getRoleName(db.currentUser.role);
                document.getElementById('userRole').className = `role-badge role-${db.currentUser.role}`;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è –≤—Å–µ—Ö
                document.getElementById('tabCourses').style.display = 'block';
                document.getElementById('tabProfile').style.display = 'block';
                
                // –í–∫–ª–∞–¥–∫–∞ "–ú–æ–∏ –æ—Ü–µ–Ω–∫–∏" –¢–û–õ–¨–ö–û –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
                if (db.currentUser.role === 'student') {
                    document.getElementById('tabGrades').style.display = 'block';
                } else {
                    document.getElementById('tabGrades').style.display = 'none';
                }
                
                // –í–∫–ª–∞–¥–∫–∞ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" –¢–û–õ–¨–ö–û –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                if (db.currentUser.role === 'admin') {
                    document.getElementById('tabAdmin').style.display = 'block';
                } else {
                    document.getElementById('tabAdmin').style.display = 'none';
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è –∏ –∞–¥–º–∏–Ω–∞
                if (db.currentUser.role === 'teacher' || db.currentUser.role === 'admin') {
                    document.getElementById('teacherControls').style.display = 'block';
                } else {
                    document.getElementById('teacherControls').style.display = 'none';
                }
                
                // –î–ª—è –∞–¥–º–∏–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã
                if (db.currentUser.role === 'admin') {
                    document.getElementById('adminControls').style.display = 'block';
                    loadAdminPanel();
                } else {
                    document.getElementById('adminControls').style.display = 'none';
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                loadCourses();
                loadGrades();
                loadProfile();
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É –∫—É—Ä—Å–æ–≤
                showTab('courses');
            } else {
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏ –∫—Ä–æ–º–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                document.getElementById('userInfo').style.display = 'none';
                document.getElementById('tabCourses').style.display = 'none';
                document.getElementById('tabGrades').style.display = 'none';
                document.getElementById('tabProfile').style.display = 'none';
                document.getElementById('tabAdmin').style.display = 'none';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                showTab('auth');
            }
        }

        function getRoleName(role) {
            const roles = {
                'student': '–°—Ç—É–¥–µ–Ω—Ç',
                'teacher': '–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å',
                'admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'
            };
            return roles[role] || role;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function handleAuth() {
            const username = document.getElementById('authUsername').value;
            const password = document.getElementById('authPassword').value;
            const action = document.getElementById('authAction').value;
            
            if (!username || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            if (action === 'login') {
                login(username, password);
            } else {
                const role = document.getElementById('registerRole').value;
                register(username, password, role);
            }
        }

        // –í—Ö–æ–¥
        function login(username, password) {
            const user = db.users.find(u => u.username === username && u.password === btoa(password));
            
            if (user) {
                db.currentUser = user;
                saveToStorage();
                showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${user.fullName || user.username}!`);
                updateUI();
            } else {
                showNotification('–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
            }
        }

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        function register(username, password, role) {
            if (db.users.find(u => u.username === username)) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                username,
                password: btoa(password),
                role,
                fullName: username,
                createdAt: new Date().toISOString()
            };
            
            db.users.push(newUser);
            saveToStorage();
            showNotification('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ.');
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
            document.getElementById('authUsername').value = '';
            document.getElementById('authPassword').value = '';
        }

        // –í—ã—Ö–æ–¥
        function logout() {
            db.currentUser = null;
            saveToStorage();
            showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
            updateUI();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫—É—Ä—Å–∞
        function showCreateCourseModal() {
            document.getElementById('createCourseModal').classList.add('active');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫—É—Ä—Å–∞ (—Ç–æ–ª—å–∫–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –∏ –∞–¥–º–∏–Ω)
        function createCourse() {
            if (!db.currentUser || (db.currentUser.role !== 'teacher' && db.currentUser.role !== 'admin')) {
                showNotification('–¢–æ–ª—å–∫–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫—É—Ä—Å—ã', 'error');
                return;
            }
            
            const name = document.getElementById('courseName').value;
            const code = document.getElementById('courseCode').value;
            const description = document.getElementById('courseDescription').value;
            
            if (!name || !code) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–æ–¥ –∫—É—Ä—Å–∞', 'error');
                return;
            }
            
            if (db.courses.find(c => c.code === code)) {
                showNotification('–ö—É—Ä—Å —Å —Ç–∞–∫–∏–º –∫–æ–¥–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                return;
            }
            
            const newCourse = {
                id: Date.now(),
                name,
                code,
                description,
                teacherId: db.currentUser.id,
                teacherName: db.currentUser.fullName || db.currentUser.username,
                students: [],
                createdAt: new Date().toISOString()
            };
            
            db.courses.push(newCourse);
            saveToStorage();
            
            // –û—á–∏—â–∞–µ–º –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º
            document.getElementById('courseName').value = '';
            document.getElementById('courseCode').value = '';
            document.getElementById('courseDescription').value = '';
            closeModal('createCourseModal');
            
            showNotification('–ö—É—Ä—Å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!');
            loadCourses();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫—É—Ä—Å–æ–≤
        function loadCourses() {
            const coursesList = document.getElementById('coursesList');
            
            if (!db.currentUser) return;
            
            let courses = [];
            
            if (db.currentUser.role === 'admin') {
                // –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –≤—Å–µ –∫—É—Ä—Å—ã
                courses = db.courses;
            } else if (db.currentUser.role === 'teacher') {
                // –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å–≤–æ–∏ –∫—É—Ä—Å—ã
                courses = db.courses.filter(c => c.teacherId === db.currentUser.id);
            } else {
                // –°—Ç—É–¥–µ–Ω—Ç –≤–∏–¥–∏—Ç –∫—É—Ä—Å—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø–∏—Å–∞–Ω
                const enrolledIds = db.enrollments
                    .filter(e => e.studentId === db.currentUser.id)
                    .map(e => e.courseId);
                courses = db.courses.filter(c => enrolledIds.includes(c.id));
            }
            
            if (courses.length === 0) {
                coursesList.innerHTML = '<p style="text-align: center; color: #666;">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫—É—Ä—Å–æ–≤</p>';
                return;
            }
            
            coursesList.innerHTML = courses.map(course => {
                const enrolledCount = db.enrollments.filter(e => e.courseId === course.id).length;
                const isEnrolled = db.enrollments.some(e => e.courseId === course.id && e.studentId === db.currentUser?.id);
                
                return `
                    <div class="course-card">
                        <h3>${course.name}</h3>
                        <div class="code">üìå –ö–æ–¥: ${course.code}</div>
                        <div class="teacher">üë®‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: ${course.teacherName}</div>
                        <p>${course.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">${enrolledCount}</div>
                                <div class="stat-label">—Å—Ç—É–¥–µ–Ω—Ç–æ–≤</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${getCourseGrades(course.id).length}</div>
                                <div class="stat-label">–æ—Ü–µ–Ω–æ–∫</div>
                            </div>
                        </div>
                        ${db.currentUser.role === 'student' && !isEnrolled ? 
                            `<button class="btn btn-success" onclick="enrollCourse(${course.id})">üìù –ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>` : 
                            ''}
                        ${db.currentUser.role === 'student' && isEnrolled ? 
                            `<span style="color: #4caf50;">‚úÖ –í—ã –∑–∞–ø–∏—Å–∞–Ω—ã</span>` : 
                            ''}
                        ${db.currentUser.role === 'teacher' && course.teacherId === db.currentUser.id ? 
                            `<button class="btn btn-primary" onclick="showGradeModal(${course.id})">‚≠ê –í—ã—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫–∏</button>` : 
                            ''}
                        ${db.currentUser.role === 'admin' ? 
                            `<button class="btn btn-danger" onclick="deleteCourse(${course.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>` : 
                            ''}
                    </div>
                `;
            }).join('');
        }

        // –ó–∞–ø–∏—Å—å –Ω–∞ –∫—É—Ä—Å (—Ç–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç)
        function enrollCourse(courseId) {
            if (!db.currentUser || db.currentUser.role !== 'student') {
                showNotification('–¢–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å—ã', 'error');
                return;
            }
            
            if (db.enrollments.some(e => e.courseId === courseId && e.studentId === db.currentUser.id)) {
                showNotification('–í—ã —É–∂–µ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ —ç—Ç–æ—Ç –∫—É—Ä—Å', 'error');
                return;
            }
            
            db.enrollments.push({
                id: Date.now(),
                courseId,
                studentId: db.currentUser.id,
                studentName: db.currentUser.fullName || db.currentUser.username,
                enrolledAt: new Date().toISOString()
            });
            
            saveToStorage();
            showNotification('–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –∫—É—Ä—Å!');
            loadCourses();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ü–µ–Ω–æ–∫ (–¢–û–õ–¨–ö–û –î–õ–Ø –°–¢–£–î–ï–ù–¢–û–í)
        function loadGrades() {
            const gradesList = document.getElementById('gradesList');
            
            if (!db.currentUser) return;
            
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—Ç—É–¥–µ–Ω—Ç - –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ü–µ–Ω–∫–∏
            if (db.currentUser.role !== 'student') {
                gradesList.innerHTML = '<p style="text-align: center; color: #666;">–≠—Ç–∞ –≤–∫–ª–∞–¥–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</p>';
                return;
            }
            
            let grades = db.grades.filter(g => g.studentId === db.currentUser.id);
            
            if (grades.length === 0) {
                gradesList.innerHTML = '<p style="text-align: center; color: #666;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ—Ü–µ–Ω–æ–∫</p>';
                return;
            }
            
            gradesList.innerHTML = `
                <table class="grade-table">
                    <thead>
                        <tr>
                            <th>–ö—É—Ä—Å</th>
                            <th>–û—Ü–µ–Ω–∫–∞</th>
                            <th>–î–∞—Ç–∞</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${grades.map(grade => {
                            const course = db.courses.find(c => c.id === grade.courseId);
                            return `
                                <tr>
                                    <td>${course ? course.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫—É—Ä—Å'}</td>
                                    <td><strong>${grade.score}</strong></td>
                                    <td>${new Date(grade.date).toLocaleDateString()}</td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                </table>
            `;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ –∫—É—Ä—Å–∞
        function getCourseGrades(courseId) {
            return db.grades.filter(g => g.courseId === courseId);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è
        function loadProfile() {
            if (!db.currentUser) return;
            
            const profileInfo = document.getElementById('profileInfo');
            
            profileInfo.innerHTML = `
                <p><strong>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong> ${db.currentUser.username}</p>
                <p><strong>–ü–æ–ª–Ω–æ–µ –∏–º—è:</strong> ${db.currentUser.fullName || db.currentUser.username}</p>
                <p><strong>–†–æ–ª—å:</strong> ${getRoleName(db.currentUser.role)}</p>
                <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> ${new Date(db.currentUser.createdAt).toLocaleDateString()}</p>
                <p><strong>ID:</strong> ${db.currentUser.id}</p>
                ${db.currentUser.role === 'student' ? `
                    <p><strong>–ö—É—Ä—Å–æ–≤:</strong> ${db.enrollments.filter(e => e.studentId === db.currentUser.id).length}</p>
                    <p><strong>–û—Ü–µ–Ω–æ–∫:</strong> ${db.grades.filter(g => g.studentId === db.currentUser.id).length}</p>
                ` : ''}
            `;
        }

        // –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function loadAdminPanel() {
            if (!db.currentUser || db.currentUser.role !== 'admin') return;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            const stats = document.getElementById('systemStats');
            stats.innerHTML = `
                <p>üë• –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${db.users.length}</p>
                <p>üìö –í—Å–µ–≥–æ –∫—É—Ä—Å–æ–≤: ${db.courses.length}</p>
                <p>üìù –í—Å–µ–≥–æ –æ—Ü–µ–Ω–æ–∫: ${db.grades.length}</p>
                <p>‚úÖ –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: ${db.enrollments.length}</p>
            `;
            
            // –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = db.users.map(user => `
                <div class="user-item">
                    <div>
                        <strong>${user.fullName || user.username}</strong> (${user.username})
                        <span class="role-badge role-${user.role}">${getRoleName(user.role)}</span>
                    </div>
                    <div>
                        <button class="btn" onclick="editUser(${user.id})">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="deleteUser(${user.id})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
            
            // –í—Å–µ –∫—É—Ä—Å—ã
            const allCourses = document.getElementById('allCoursesList');
            allCourses.innerHTML = db.courses.map(course => {
                const teacher = db.users.find(u => u.id === course.teacherId);
                return `
                    <div class="course-card">
                        <h3>${course.name}</h3>
                        <div class="code">${course.code}</div>
                        <div class="teacher">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: ${teacher ? teacher.fullName || teacher.username : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                        <p>${course.description}</p>
                        <button class="btn btn-danger" onclick="deleteCourse(${course.id})">–£–¥–∞–ª–∏—Ç—å –∫—É—Ä—Å</button>
                    </div>
                `;
            }).join('');
            
            // –í—Å–µ –æ—Ü–µ–Ω–∫–∏
            const allGrades = document.getElementById('allGradesList');
            allGrades.innerHTML = `
                <table class="grade-table">
                    <thead>
                        <tr>
                            <th>–°—Ç—É–¥–µ–Ω—Ç</th>
                            <th>–ö—É—Ä—Å</th>
                            <th>–û—Ü–µ–Ω–∫–∞</th>
                            <th>–î–∞—Ç–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${db.grades.map(grade => {
                            const student = db.users.find(u => u.id === grade.studentId);
                            const course = db.courses.find(c => c.id === grade.courseId);
                            return `
                                <tr>
                                    <td>${student ? student.fullName || student.username : ''}</td>
                                    <td>${course ? course.name : ''}</td>
                                    <td>${grade.score}</td>
                                    <td>${new Date(grade.date).toLocaleDateString()}</td>
                                    <td><button class="btn btn-danger" onclick="deleteGrade(${grade.id})">üóëÔ∏è</button></td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                </table>
            `;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function showAddUserModal() {
            document.getElementById('addUserModal').classList.add('active');
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
        function addUser() {
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;
            const role = document.getElementById('newRole').value;
            
            if (!username || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            if (db.users.find(u => u.username === username)) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                username,
                password: btoa(password),
                role,
                fullName: username,
                createdAt: new Date().toISOString()
            };
            
            db.users.push(newUser);
            saveToStorage();
            
            closeModal('addUserModal');
            showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω');
            loadAdminPanel();
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
        function deleteUser(userId) {
            if (userId === db.currentUser?.id) {
                showNotification('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å —Å–µ–±—è', 'error');
                return;
            }
            
            if (confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                db.users = db.users.filter(u => u.id !== userId);
                saveToStorage();
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω');
                loadAdminPanel();
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
        function deleteCourse(courseId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∫—É—Ä—Å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                db.courses = db.courses.filter(c => c.id !== courseId);
                db.enrollments = db.enrollments.filter(e => e.courseId !== courseId);
                db.grades = db.grades.filter(g => g.courseId !== courseId);
                saveToStorage();
                showNotification('–ö—É—Ä—Å —É–¥–∞–ª–µ–Ω');
                loadCourses();
                if (db.currentUser?.role === 'admin') loadAdminPanel();
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
        function deleteGrade(gradeId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –æ—Ü–µ–Ω–∫—É?')) {
                db.grades = db.grades.filter(g => g.id !== gradeId);
                saveToStorage();
                showNotification('–û—Ü–µ–Ω–∫–∞ —É–¥–∞–ª–µ–Ω–∞');
                loadGrades();
                if (db.currentUser?.role === 'admin') loadAdminPanel();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫
        function showGradeModal(courseId) {
            const course = db.courses.find(c => c.id === courseId);
            if (!course) return;
            
            const students = db.enrollments
                .filter(e => e.courseId === courseId)
                .map(e => {
                    const student = db.users.find(u => u.id === e.studentId);
                    return { ...e, student };
                });
            
            const modal = document.getElementById('gradeModal');
            const form = document.getElementById('gradeForm');
            
            if (students.length === 0) {
                form.innerHTML = '<p>–ù–∞ –∫—É—Ä—Å –µ—â–µ –Ω–∏–∫—Ç–æ –Ω–µ –∑–∞–ø–∏—Å–∞–ª—Å—è</p>';
            } else {
                form.innerHTML = `
                    <h3>–ö—É—Ä—Å: ${course.name}</h3>
                    ${students.map(s => `
                        <div style="margin: 15px 0; padding: 10px; background: #f5f5f5; border-radius: 5px;">
                            <p><strong>${s.student.fullName || s.student.username}</strong></p>
                            <input type="number" id="grade-${s.studentId}" min="0" max="100" placeholder="–û—Ü–µ–Ω–∫–∞ (0-100)">
                            <button class="btn btn-success" onclick="submitGrade(${courseId}, ${s.studentId})">–í—ã—Å—Ç–∞–≤–∏—Ç—å</button>
                        </div>
                    `).join('')}
                `;
            }
            
            modal.classList.add('active');
        }

        // –í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ (—Ç–æ–ª—å–∫–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å)
        function submitGrade(courseId, studentId) {
            const score = document.getElementById(`grade-${studentId}`).value;
            
            if (!score || score < 0 || score > 100) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –æ—Ü–µ–Ω–∫—É –æ—Ç 0 –¥–æ 100', 'error');
                return;
            }
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –æ—Ü–µ–Ω–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å
            db.grades = db.grades.filter(g => !(g.courseId === courseId && g.studentId === studentId));
            
            db.grades.push({
                id: Date.now(),
                courseId,
                studentId,
                score: parseInt(score),
                teacherId: db.currentUser.id,
                date: new Date().toISOString()
            });
            
            saveToStorage();
            showNotification('–û—Ü–µ–Ω–∫–∞ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∞');
            closeModal('gradeModal');
            loadCourses();
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫—É—Ä—Å—ã (–¥–ª—è –∞–¥–º–∏–Ω–∞)
        function showAllCourses() {
            loadCourses();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∫—É—Ä—Å—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ (–¥–ª—è –∞–¥–º–∏–Ω–∞)
        function showPendingCourses() {
            showNotification('–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function editUser(userId) {
            showNotification('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏');
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –≤—ã–±–æ—Ä —Ä–æ–ª–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        document.getElementById('authAction').addEventListener('change', function(e) {
            const roleSelect = document.getElementById('roleSelect');
            roleSelect.style.display = e.target.value === 'register' ? 'block' : 'none';
        });

        // –ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        updateUI();
    </script>
</body>
</html>