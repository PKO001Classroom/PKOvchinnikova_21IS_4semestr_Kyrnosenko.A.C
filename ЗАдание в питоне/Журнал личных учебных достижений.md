# 3 файл - Журнал личных учебных достижений
```python
# main
## Основной файл программы
import tkinter as tk
from tkinter import ttk
from tkinter import messagebox
import sqlite3
import json
from docx import Document
from datetime import datetime

def init_db():
    conn = sqlite3.connect('achievements.db')
    cursor = conn.cursor()
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS achievements (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            name TEXT NOT NULL,
            date TEXT NOT NULL,
            type TEXT NOT NULL,
            level TEXT NOT NULL,
            description TEXT
        )
    ''')
    conn.commit()
    conn.close()

def load_types():
    try:
        with open('types.json', 'r', encoding='utf-8') as f:
            return json.load(f)
    except FileNotFoundError:
        return ["Олимпиада", "Сертификат", "Проект", "Экзамен", "Конференция"]

def create_add_form(parent):
    tk.Label(parent, text="Название:").pack(anchor="w", padx=10, pady=5)
    name_entry = tk.Entry(parent, width=50)
    name_entry.pack(pady=10, padx=5)
    tk.Label(parent, text="Дата (ГГГГ-ММ-ДД):").pack(anchor="w", padx=10, pady=5)
    date_entry = tk.Entry(parent, width=20)
    date_entry.pack(pady=10, padx=5)
    tk.Label(parent, text="Тип:").pack(anchor="w", padx=10, pady=5)
    type_combo = ttk.Combobox(parent, values=load_types(), state="readonly")
    type_combo.pack(pady=10, padx=5)
    type_combo.set(load_types()[0])
    tk.Label(parent, text="Уровень:").pack(anchor="w", padx=10, pady=5)
    level_combo = ttk.Combobox(parent, values=["локальный", "региональный", "национальный"], state="readonly")
    level_combo.pack(pady=10, padx=5)
    level_combo.set("локальный")
    tk.Label(parent, text="Описание:").pack(anchor="w", padx=10, pady=5)
    desc_text = tk.Text(parent, height=4, width=50)
    desc_text.pack(pady=10, padx=5)
    save_btn = tk.Button(parent, text="Сохранить")
    save_btn.pack(pady=10)
    return name_entry, date_entry, type_combo, level_combo, desc_text, save_btn

def save_achievement(name_entry, date_entry, type_combo, level_combo, desc_text):
    name = name_entry.get().strip()
    date = date_entry.get().strip()
    atype = type_combo.get()
    level = level_combo.get()
    description = desc_text.get("1.0", tk.END).strip()
    if not name or not date:
        messagebox.showwarning("Ошибка", "Название и дата обязательны")
        return
    try:
        datetime.strptime(date, "%Y-%m-%d")
    except ValueError:
        messagebox.showwarning("Ошибка", "Дата должна быть в формате ГГГГ-ММ-ДД")
        return
    conn = sqlite3.connect('achievements.db')
    cursor = conn.cursor()
    cursor.execute('''
        INSERT INTO achievements (name, date, type, level, description)
        VALUES (?, ?, ?, ?, ?)
    ''', (name, date, atype, level, description))
    conn.commit()
    conn.close()
    name_entry.delete(0, tk.END)
    date_entry.delete(0, tk.END)
    desc_text.delete("1.0", tk.END)
    messagebox.showinfo("Успех", "Достижение сохранено")
    refresh_list()

def refresh_list():
    for row in tree.get_children():
        tree.delete(row)
    conn = sqlite3.connect('achievements.db')
    cursor = conn.cursor()
    cursor.execute("SELECT id, name, date, type, level FROM achievements")
    rows = cursor.fetchall()
    conn.close()
    for row in rows:
        tree.insert("", tk.END, values=row)

def delete_selected():
    selected = tree.selection()
    if not selected:
        return
    item = tree.item(selected[0])
    record_id = item['values'][0]
    conn = sqlite3.connect('achievements.db')
    cursor = conn.cursor()
    cursor.execute("DELETE FROM achievements WHERE id=?", (record_id,))
    conn.commit()
    conn.close()
    refresh_list()

def export_to_word():
    conn = sqlite3.connect('achievements.db')
    cursor = conn.cursor()
    cursor.execute("SELECT name, date, type, level, description FROM achievements")
    rows = cursor.fetchall()
    conn.close()
    if not rows:
        messagebox.showwarning("Экспорт", "Нет данных для экспорта")
        return
    export_path = r"C:\Users\Student\Desktop\21Is\Проект3\достижения.docx"
    doc = Document()
    doc.add_heading('Мои достижения', 0)
    for row in rows:
        doc.add_heading(row[0], level=1)
        doc.add_paragraph(f"Дата: {row[1]}")
        doc.add_paragraph(f"Тип: {row[2]}")
        doc.add_paragraph(f"Уровень: {row[3]}")
        doc.add_paragraph(f"Описание: {row[4]}")
        doc.add_paragraph()
    doc.save(export_path)
    messagebox.showinfo("Экспорт", f"Данные экспортированы в:\n{export_path}")

init_db()
root = tk.Tk()
root.title("Журнал достижений")
root.geometry("600x400")
notebook = ttk.Notebook(root)
notebook.pack(fill="both", expand=True)
tab_add = tk.Frame(notebook)
tab_list = tk.Frame(notebook)
notebook.add(tab_add, text="Добавить")
notebook.add(tab_list, text="Мои достижения")
name_entry, date_entry, type_combo, level_combo, desc_text, save_btn = create_add_form(tab_add)
save_btn.config(command=lambda: save_achievement(name_entry, date_entry, type_combo, level_combo, desc_text))
columns = ("id", "Название", "Дата", "Тип", "Уровень")
tree = ttk.Treeview(tab_list, columns=columns, show="headings")
for col in columns:
    tree.heading(col, text=col)
    tree.column(col, width=100)
tree.pack(fill="both", expand=True, padx=10, pady=10)
btn_frame = tk.Frame(tab_list)
btn_frame.pack()
tk.Button(btn_frame, text="Удалить выбранное", command=delete_selected).pack(side="left", padx=5)
tk.Button(btn_frame, text="Экспорт в Word", command=export_to_word).pack(side="left", padx=5)
refresh_list()
root.mainloop()

```

---

```json
# Файл со списком типов достижений
["Олимпиада", "Сертификат", "Проект", "Экзамен", "Конференция"]

```
